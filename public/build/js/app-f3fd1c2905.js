$(function(){$("#ajax-status").click(function(){$(this).hide()}),$("#send").click(function(){var e=$("#content").val(),i=e.replace(/\ +/g,"");if(""==e||""==i)return $("#content").val("").attr("placeholder","老大，我很饿...."),!1;$("#message-form").submit()});var e=[];$(".get-comments").click(function(){var i=$(this).parent().next();i.is(":hidden")?i.show():i.hide();var a=$(this).parent().attr("data-id");-1==$.inArray(a,e)&&($.ajax({type:"get",url:"/article/get-comments/"+a,dataType:"json",success:function(e){var i="";return $(e.comments).each(function(e,a){i+='<div><span class="author"><i class="fa fa-user" aria-hidden="true"></i> 匿名用户 &nbsp;&nbsp;<i>'+a.Created_at+"</i></span><p>"+a.Comment+"</p><hr></div>"}),$("#"+e.id).prev().html(i),1==e.all_page?void $("#"+e.id).children("div").hide():1==e.current_page?($("#"+e.id).children("div").children("span").removeClass("disabled"),void $("#"+e.id).children("div").children(".comment-prev").addClass("disabled")):e.current_page==e.all_page?($("#"+e.id).children("div").children("span").removeClass("disabled"),void $("#"+e.id).children("div").children(".comment-next").addClass("disabled")):void 0},error:function(e){console.log(e)}}),e.push(a))}),$(".comment-next, .comment-prev").click(function(){if(!$(this).is(".disabled")){var e=$(this).parent().parent().attr("id"),i=$(this).parent().parent().data("currpage");if($(this).is(".comment-next"))var a=Number(i)+1;else var a=Number(i)-1;$.ajax({type:"get",url:"/article/get-comments/"+e+"?page="+a,dataType:"json",success:function(e){var i="";return $(e.comments).each(function(e,a){i+='<div><span class="author"><i class="fa fa-user" aria-hidden="true"></i> 匿名用户 &nbsp;&nbsp;<i>'+a.Created_at+"</i></span><p>"+a.Comment+"</p><hr></div>"}),$("#"+e.id).prev().html(i),1==e.all_page?void $("#"+e.id).children("div").hide():1==e.current_page?($("#"+e.id).children("div").children("span").removeClass("disabled"),$("#"+e.id).children("div").children("a").text(e.current_page),$("#"+e.id).data("currpage",e.current_page),void $("#"+e.id).children("div").children(".comment-prev").addClass("disabled")):e.current_page>=e.all_page?($("#"+e.id).children("div").children("span").removeClass("disabled"),$("#"+e.id).children("div").children("a").text(e.current_page),$("#"+e.id).data("currpage",e.current_page),void $("#"+e.id).children("div").children(".comment-next").addClass("disabled")):void 0},error:function(e){console.log(e)}})}}),$(".btn-comment").click(function(){var e=$(this).prev().val(),i=$(this).parent().attr("id"),a=e.replace(/\ +/g,"");if(""==e||""==a)return $(this).prev().val("").attr("placeholder","请写下你的评论"),!1;$.ajax({type:"post",url:"/article/add-comment",headers:{"X-CSRF-TOKEN":$("input[name=_csrf]").val()},dataType:"json",data:{comment:e,article_id:i},success:function(e){$("#"+e.id).children("input").val(""),$("#"+e.id).prev().append('<div><span class="author"><i class="fa fa-user" aria-hidden="true"></i> 匿名用户 &nbsp;&nbsp;<i>'+e.created_at+"</i></span><p>"+e.comment+"</p><hr></div>");var i=$("#"+e.id).parent().prev().find("i:last");i.text(Number(i.text())+1)},error:function(e){console.log(e)}})})}),$(".btn-thx").click(function(){var e=$(this).children("i:last-child"),i=$(this).parent().attr("data-id");e.text(Number(e.text())+1),$(this).unbind("click"),$.get("/article/add-thank/"+i)});